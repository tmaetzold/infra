---
# Configure all infrastructure
- name: Configure common packages and settings on all hosts
  hosts: all
  become: true
  tasks:
    - name: Set system timezone
      community.general.timezone:
        name: "{{ timezone }}"

    - name: Remove unwanted packages
      ansible.builtin.package:
        name: "{{ remove_packages }}"
        state: absent
      when: remove_packages is defined and remove_packages | length > 0

    - name: Add packages
      ansible.builtin.package:
        name: "{{ add_packages }}"
        state: present
      when: add_packages is defined and add_packages | length > 0

- name: Configure Docker and NFS on swarm hosts
  hosts: swarm
  become: true
  roles:
    - geerlingguy.docker
    - geerlingguy.nfs

# Future Docker Swarm configuration
# - name: Configure Docker Swarm cluster
#   hosts: swarm
#   become: true
#   tasks:
#     - name: Initialize Docker Swarm (on first node)
#       # Add swarm initialization tasks here
